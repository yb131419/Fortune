<style>
  /* 整體背景和字體 */
  body {
    background: linear-gradient(135deg, #4b0082, #8a2be2);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #f0eaff;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding: 60px 20px;
  }

  .container {
    background: rgba(255 255 255 / 0.1);
    border-radius: 20px;
    box-shadow: 0 8px 30px rgba(138, 43, 226, 0.5);
    padding: 40px 50px 50px;
    width: 400px;
    max-width: 95vw;
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
  }

  input#inputText {
    width: 100%;
    padding: 14px 18px;
    border-radius: 12px;
    border: none;
    font-size: 18px;
    font-weight: 600;
    color: #4b0082;
    background: #f0eaff;
    box-shadow: inset 0 0 6px #a085ffaa;
    transition: box-shadow 0.3s ease, background-color 0.3s ease;
  }

  input#inputText::placeholder {
    color: #b3a3f5;
    font-weight: 500;
  }

  input#inputText:focus {
    outline: none;
    background-color: #fff;
    box-shadow: 0 0 15px #bb99ffcc;
  }

  button {
    margin-top: 20px;
    width: 100%;
    padding: 16px 0;
    border-radius: 12px;
    border: none;
    background: linear-gradient(90deg, #9c27b0, #7b1fa2);
    font-size: 20px;
    font-weight: 700;
    color: white;
    cursor: pointer;
    box-shadow: 0 6px 20px #7b1fa2cc;
    transition: background 0.4s ease, box-shadow 0.3s ease;
    user-select: none;
  }

  button:hover {
    background: linear-gradient(90deg, #b452d1, #8a3ab7);
    box-shadow: 0 8px 25px #8a3ab7dd;
  }

  button:active {
    transform: scale(0.97);
  }

  #result {
    margin-top: 32px;
    background: rgba(255 255 255 / 0.15);
    border-radius: 16px;
    padding: 25px 30px;
    box-shadow: 0 8px 20px rgba(75, 0, 130, 0.5);
    font-size: 16px;
    line-height: 1.5;
    color: #e3dfff;
    min-height: 150px;
    user-select: text;
    white-space: pre-line;
  }

  #result h3 {
    font-weight: 700;
    font-size: 22px;
    margin-bottom: 14px;
    text-shadow: 0 0 10px #a685ff;
  }

  #result p {
    margin: 8px 0;
  }

  #result p[id="aiComment"] {
    margin-top: 20px;
    font-style: italic;
    font-size: 17px;
    color: #d1c4e9;
    text-shadow: 0 0 6px #d1c4e9aa;
  }

  #result p[style*="color:red"] {
    font-weight: 700;
    font-size: 16px;
    text-shadow: 0 0 5px #ff5c5c;
  }
</style>

<div class="container">
  <input id="inputText" placeholder="請輸入手機號碼或英文姓名" autocomplete="off" />
  <button onclick="analyze()">開始分析</button>
  <div id="result"></div>
</div>

<script>
  function analyze() {
    const input = document.getElementById("inputText").value.trim();
    if (!input) {
      alert("請輸入手機號碼或英文姓名");
      return;
    }
    const oldScript = document.getElementById("jsonpScript");
    if (oldScript) oldScript.remove();

    const script = document.createElement("script");
    script.id = "jsonpScript";
    script.src = `https://script.google.com/macros/s/AKfycbwMo0eah1i6yur2O2trtS-ICiIg4JD5eqHc3TfmLHx3gUXTZnynlZMpouJddOmEDJOo/exec?input=${encodeURIComponent(input)}&callback=showResult`;
    document.body.appendChild(script);
  }

  function showResult(data) {
    if (data.error) {
      document.getElementById("result").innerHTML = `<p style="color:red;">⚠️ ${data.error}</p>`;
      return;
    }
    document.getElementById("result").innerHTML = `
      <h3>輸入：${data.input}</h3>
      <p>數字轉換後：${data.numericStr}</p>
      <p>八星統計：${data.summary}</p>
      <p>主導星曜：${data.dominant}星</p>
      <p id="aiComment"></p>
    `;
    document.getElementById("aiComment").textContent = `彥彬 評語：${data.comment}`;
    console.log("彥彬 評語全文:", data.comment);
  }
</script>
